---
title: "CSCI403 Analysis"
output:
  pdf_document: default
  html_notebook: default
---

```{r}
library(emmeans)
library(Stat2Data)
library(tidyverse)
library(mosaic)
library(ggformula)
library(dplyr)

knitr::opts_chunk$set(echo = F)
evData <- read.csv("data/Electric Vehicle Data.csv")
legData <- read.csv("data/clean_legislative.csv")
```

First, we can start by checking to see if the electric vehicle type results in different electric ranges.

```{r}
# Start by deleting all rows with an electric range of zero
evData <- filter(evData, Electric.Range != 0)

model <- aov(Electric.Range ~ Electric.Vehicle.Type, data = evData)

df_summary <- evData %>%
  group_by(Electric.Vehicle.Type) %>%
  summarize(
    n = n(),
    mean = mean(Electric.Range, na.rm = TRUE),
    sd = sd(Electric.Range, na.rm = TRUE)
  )
df_summary
```

```{r}
# Start by filtering the data to only include rows with the Battery Electric Vehicle (BEV) column value
onlyElectric <- filter(evData, Electric.Vehicle.Type == "Battery Electric Vehicle (BEV)")
# Create a new dataframe w
teslaModel <- aov(Electric.Range ~ Make, data = onlyElectric)

```

Do we have evidence to show that electric cars have increased in average range in 2020 compared to in 2019?

```{r}
yearElectric <- filter(onlyElectric, Model.Year == 2020 | Model.Year == 2019)
yearModel <- aov(Electric.Range ~ Model.Year, data = yearElectric)
df_summary <- yearElectric %>%
  group_by(Model.Year) %>%
  summarize(
    n = n(),
    mean = mean(Electric.Range, na.rm = TRUE),
    sd = sd(Electric.Range, na.rm = TRUE)
  )
df_summary
summary(yearModel)
model_means = emmeans(yearModel, ~ Model.Year)
pairs(model_means, adjust = "tukey")
```

```{r}
#length(filter(evData, Model.Year == 2020)$Electric.Range)
#hist(evData$Model.Year, breaks=seq(1999, 2026, by = 1))

# The big question: do we have evidence to show that the leading political party in a legislative district results in fewer or more electric cars compared to other political parties?
legModel <- aov(total_votes ~ party, data = legData)
df_summary <- legData %>%
  group_by(party) %>%
  summarize(
    n = n(),
    mean = mean(total_votes, na.rm = TRUE),
    sd = sd(total_votes, na.rm = TRUE)
  )
df_summary
summary(legModel)
model_means = emmeans(legModel, ~ party)
pairs(model_means, adjust = "tukey")
```